import requests, zipfile, io
import os
import requests
import csv
from io import BytesIO
import httpx

url = ["https://bazaar.abuse.ch/export/txt/sha256/full/","https://bazaar.abuse.ch/export/txt/md5/full/","https://bazaar.abuse.ch/export/txt/sha1/full/"]

def zip_files(zipfiles=[],csvfiles=[]):
    for i in url:
        r = requests.get(i)
        z = zipfile.ZipFile(io.BytesIO(r.content))
        z.extractall(".")

zip_files(["https://bazaar.abuse.ch/export/txt/sha256/full/","https://bazaar.abuse.ch/export/txt/md5/full/","https://bazaar.abuse.ch/export/txt/sha1/full/"])

def recent_files():    
    csv_url = "https://bazaar.abuse.ch/export/csv/recent/"
    csv_url1 = "https://bazaar.abuse.ch/export/csv/full/"
    url2 = "https://bazaar.abuse.ch/export/txt/sha256/recent/"
    url3 = "https://bazaar.abuse.ch/export/txt/md5/recent/"
    url4 = "https://bazaar.abuse.ch/export/txt/sha1/recent/"
    
    req = requests.get(csv_url)
    req1 = requests.get(csv_url1)
    req2 = requests.get(url2)
    req3 = requests.get(url3)
    req4= requests.get(url4)
   
    url_content = req.content
    url_content1 = req1.content
    url_content2 = req2.content
    url_content3 = req3.content
    url_content4 = req4.content
    
    csv_file = open('malware_recent.txt', 'wb')
    csv_file.write(url_content)
    
    csv_file1 = open('malware_full.txt', 'wb')
    csv_file1.write(url_content1)

    csv_file2 = open('sha256_recent.txt', 'wb')
    csv_file2.write(url_content2)

    csv_file3 = open('md5_recent.txt', 'wb')
    csv_file3.write(url_content3)

    csv_file4 = open('sha1_recent.txt', 'wb')
    csv_file4.write(url_content4)
    
    csv_file.close()  
    csv_file1.close()
    csv_file2.close()
    csv_file3.close()
    csv_file4.close()

recent_files()




